<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Глава 3 Как добавить боту поддержку клавиатуры | Разработка telegram ботов на языке R</title>
<meta name="author" content="Алексей Селезнёв">
<meta name="description" content="В этой главе мы познакомимся с важным аспектом разработки Telegram-ботов - добавлением поддержки клавиатуры для более удобного взаимодействия пользователей с ботом. Из этой главы вы узнаете: О...">
<meta name="generator" content="bookdown 0.43 with bs4_book()">
<meta property="og:title" content="Глава 3 Как добавить боту поддержку клавиатуры | Разработка telegram ботов на языке R">
<meta property="og:type" content="book">
<meta property="og:image" content="/cover.png">
<meta property="og:description" content="В этой главе мы познакомимся с важным аспектом разработки Telegram-ботов - добавлением поддержки клавиатуры для более удобного взаимодействия пользователей с ботом. Из этой главы вы узнаете: О...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Глава 3 Как добавить боту поддержку клавиатуры | Разработка telegram ботов на языке R">
<meta name="twitter:description" content="В этой главе мы познакомимся с важным аспектом разработки Telegram-ботов - добавлением поддержки клавиатуры для более удобного взаимодействия пользователей с ботом. Из этой главы вы узнаете: О...">
<meta name="twitter:image" content="/cover.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.8.0/transition.js"></script><script src="libs/bs3compat-0.8.0/tabs.js"></script><script src="libs/bs3compat-0.8.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114798296-1"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-114798296-1');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Разработка telegram ботов на языке R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Введение</a></li>
<li><a class="" href="%D0%BF%D1%80%D0%B5%D0%B4%D0%B8%D1%81%D0%BB%D0%BE%D0%B2%D0%B8%D0%B5.html">Предисловие</a></li>
<li><a class="" href="%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D1%91%D0%BC-%D0%B1%D0%BE%D1%82%D0%B0-%D0%B8-%D0%BE%D1%82%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D1%8F%D0%B5%D0%BC-%D1%81-%D0%B5%D0%B3%D0%BE-%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E-%D1%81%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F-%D0%B2-telegram.html"><span class="header-section-number">1</span> Создаём бота и отправляем с его помощью сообщения в telegram</a></li>
<li><a class="" href="%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%BB%D1%8F%D0%B5%D0%BC-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BE%D0%BC%D0%B0%D0%BD%D0%B4-%D0%B8-%D1%84%D0%B8%D0%BB%D1%8C%D1%82%D1%80%D1%8B-%D1%81%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D0%B9-%D0%BA%D0%BB%D0%B0%D1%81%D1%81-updater.html"><span class="header-section-number">2</span> Добавляем боту поддержку команд и фильтры сообщений, класс Updater</a></li>
<li><a class="active" href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html"><span class="header-section-number">3</span> Как добавить боту поддержку клавиатуры</a></li>
<li><a class="" href="%D0%BF%D0%BE%D1%81%D1%82%D1%80%D0%BE%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D0%BE%D1%81%D0%BB%D0%B5%D0%B4%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D0%BE%D0%B3%D0%BE-%D0%BB%D0%BE%D0%B3%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%BE%D0%B3%D0%BE-%D0%B4%D0%B8%D0%B0%D0%BB%D0%BE%D0%B3%D0%B0-%D1%81-%D0%B1%D0%BE%D1%82%D0%BE%D0%BC.html"><span class="header-section-number">4</span> Построение последовательного, логического диалога с ботом</a></li>
<li><a class="" href="%D0%B8%D0%BD%D1%82%D0%B5%D0%B3%D1%80%D0%B8%D1%80%D1%83%D0%B5%D0%BC-%D0%B2-%D0%B1%D0%BE%D1%82%D0%B0-%D0%B8%D1%81%D0%BA%D1%83%D1%81%D1%81%D1%82%D0%B2%D0%B5%D0%BD%D0%BD%D1%8B%D0%B9-%D0%B8%D0%BD%D1%82%D0%B5%D0%BB%D0%BB%D0%B5%D0%BA%D1%82.html"><span class="header-section-number">5</span> Интегрируем в бота искусственный интеллект</a></li>
<li><a class="" href="%D1%83%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D1%80%D0%B0%D0%B2%D0%B0%D0%BC%D0%B8-%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D0%B5%D0%B9-%D0%B1%D0%BE%D1%82%D0%B0.html"><span class="header-section-number">6</span> Управление правами пользователей бота</a></li>
<li><a class="" href="%D0%BF%D0%BE%D0%B2%D1%8B%D1%88%D0%B0%D0%B5%D0%BC-%D1%81%D1%82%D0%B0%D0%B1%D0%B8%D0%BB%D1%8C%D0%BD%D0%BE%D1%81%D1%82%D1%8C-%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D1%8B-%D0%B1%D0%BE%D1%82%D0%B0.html"><span class="header-section-number">7</span> Повышаем стабильность работы бота</a></li>
<li><a class="" href="%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%BB%D1%8F%D0%B5%D0%BC-%D0%B1%D0%BE%D1%82%D1%83-%D0%B0%D1%81%D0%B8%D0%BD%D1%85%D1%80%D0%BE%D0%BD%D0%BD%D0%BE%D1%81%D1%82%D1%8C.html"><span class="header-section-number">8</span> Добавляем боту асинхронность</a></li>
<li><a class="" href="%D1%83%D0%BF%D0%B0%D0%BA%D0%BE%D0%B2%D1%8B%D0%B2%D0%B0%D0%B5%D0%BC-%D0%B1%D0%BE%D1%82%D0%B0-%D0%B2-docker-%D0%BA%D0%BE%D0%BD%D1%82%D0%B5%D0%B9%D0%BD%D0%B5%D1%80.html"><span class="header-section-number">9</span> Упаковываем бота в Docker контейнер</a></li>
<li><a class="" href="%D1%80%D0%B0%D0%B7%D0%B2%D0%BE%D1%80%D0%B0%D1%87%D0%B8%D0%B2%D0%B0%D0%B5%D0%BC-%D0%B1%D0%BE%D1%82%D0%B0-%D0%B2-%D0%BE%D0%B1%D0%BB%D0%B0%D1%87%D0%BD%D1%8B%D1%85-%D1%81%D0%B5%D1%80%D0%B2%D0%B8%D1%81%D0%B0%D1%85.html"><span class="header-section-number">10</span> Разворачиваем бота в облачных сервисах</a></li>
<li><a class="" href="%D0%B7%D0%B0%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%BD%D0%B8%D0%B5-10.html">Заключение</a></li>
<li><a class="" href="%D0%BE%D0%B1%D0%BD%D0%BE%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D1%8F.html">Обновления</a></li>
<li><a class="" href="%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B5-%D0%B7%D0%B0%D0%B4%D0%B0%D1%87.html">Решение задач</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="как-добавить-боту-поддержку-клавиатуры" class="section level1" number="3">
<h1>
<span class="header-section-number">Глава 3</span> Как добавить боту поддержку клавиатуры<a class="anchor" aria-label="anchor" href="#%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B"><i class="fas fa-link"></i></a>
</h1>
<p>В этой главе мы познакомимся с важным аспектом разработки Telegram-ботов - добавлением поддержки клавиатуры для более удобного взаимодействия пользователей с ботом.</p>
<p>Из этой главы вы узнаете:</p>
<ul>
<li>О двух основных типах клавиатур в Telegram: Reply и Inline</li>
<li>Как создавать и настраивать Reply-клавиатуру под панелью ввода текста</li>
<li>Как реализовать Inline-клавиатуру, привязанную к конкретным сообщениям бота</li>
<li>Как обрабатывать нажатия на кнопки клавиатур с помощью пакета telegram.bot для R</li>
<li>Как структурировать код бота для работы с клавиатурами</li>
<li>Практические примеры реализации ботов с клавиатурами для различных задач</li>
</ul>
<p>Я подробно разберу процесс создания обоих типов клавиатур, приведу примеры кода для реализации нескольких полезных ботов. Вы познакомитесь с ботом для экспресс-тестирования на COVID-19, ботом для получения информации о погоде и ботом для вывода списка свежих статей с Хабра.
Я дам детальные объяснения структуры кода, функций для создания кнопок и обработки нажатий, а также рекомендации по построению логики работы бота с клавиатурами.</p>
<p>Освоив материал этой главы, вы сможете значительно улучшить удобство использования своих Telegram-ботов, сделав взаимодействие с ними более простым и интуитивно понятным для пользователей.</p>
<div id="видео-урок-по-добавлению-боту-клавиатуры" class="section level2" number="3.1">
<h2>
<span class="header-section-number">3.1</span> Видео урок по добавлению боту клавиатуры<a class="anchor" aria-label="anchor" href="#%D0%B2%D0%B8%D0%B4%D0%B5%D0%BE-%D1%83%D1%80%D0%BE%D0%BA-%D0%BF%D0%BE-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D1%8E-%D0%B1%D0%BE%D1%82%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B"><i class="fas fa-link"></i></a>
</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/QKHkL_GLy-M?enablejsapi=1" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
</div>
<div id="какие-типы-клавиатур-поддерживает-телеграм-бот" class="section level2" number="3.2">
<h2>
<span class="header-section-number">3.2</span> Какие типы клавиатур поддерживает телеграм бот<a class="anchor" aria-label="anchor" href="#%D0%BA%D0%B0%D0%BA%D0%B8%D0%B5-%D1%82%D0%B8%D0%BF%D1%8B-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%B8%D0%B2%D0%B0%D0%B5%D1%82-%D1%82%D0%B5%D0%BB%D0%B5%D0%B3%D1%80%D0%B0%D0%BC-%D0%B1%D0%BE%D1%82"><i class="fas fa-link"></i></a>
</h2>
<p>На момент написания книги <code>telegram.bot</code> позволяет вам создать клавиатуры двух типов:</p>
<ul>
<li>Reply - Основная, обычная клавиатура, которая находится под панелью ввода текста сообщения. Такая клавиатура просто отправляет боту текстовое сообщение, и в качестве текста отправит тот текст, который написан на самой кнопке.</li>
<li>Inline - Клавиатура привязанная к конкретному сообщению бота. Данная клавиатура отправляет боту данные, привязанные к нажатой кнопке, эти данные могут отличаться от текста, написанного на самой кнопке. И обрабатываются такие кнопки через <strong>CallbackQueryHandler</strong>.</li>
</ul>
<p>Для того, что бы бот открыл клавиатуру необходимо при отправке сообщения через метод <code>sendMessage()</code>, передать созданную ранее клавиатуру в аргумент <code>reply_markup</code>.</p>
<p>Ниже мы разберём несколько примеров.</p>
</div>
<div id="reply-клавиатура" class="section level2" number="3.3">
<h2>
<span class="header-section-number">3.3</span> Reply клавиатура<a class="anchor" aria-label="anchor" href="#reply-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D0%B0"><i class="fas fa-link"></i></a>
</h2>
<p>Как я уже писал выше, это основная клавиатура управления ботом.</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/Bot.html">Bot</a></span><span class="op">(</span>token <span class="op">=</span> <span class="st">"TOKEN"</span><span class="op">)</span></span>
<span><span class="va">chat_id</span> <span class="op">&lt;-</span> <span class="st">"CHAT_ID"</span></span>
<span></span>
<span><span class="co"># Create Custom Keyboard</span></span>
<span><span class="va">text</span> <span class="op">&lt;-</span> <span class="st">"Aren't those custom keyboards cool?"</span></span>
<span><span class="va">RKM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/ReplyKeyboardMarkup.html">ReplyKeyboardMarkup</a></span><span class="op">(</span></span>
<span>  keyboard <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/KeyboardButton.html">KeyboardButton</a></span><span class="op">(</span><span class="st">"Yes, they certainly are!"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/KeyboardButton.html">KeyboardButton</a></span><span class="op">(</span><span class="st">"I'm not quite sure"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/KeyboardButton.html">KeyboardButton</a></span><span class="op">(</span><span class="st">"No..."</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  resize_keyboard <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  one_time_keyboard <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Send Custom Keyboard</span></span>
<span><span class="va">bot</span><span class="op">$</span><span class="fu">sendMessage</span><span class="op">(</span><span class="va">chat_id</span>, <span class="va">text</span>, reply_markup <span class="op">=</span> <span class="va">RKM</span><span class="op">)</span></span></code></pre></div>
<p>Выше приведён пример из официальной справки пакета <code>telegram.bot</code>. Для создания клавиатуры используется функция <code><a href="https://rdrr.io/pkg/telegram.bot/man/ReplyKeyboardMarkup.html">ReplyKeyboardMarkup()</a></code>, которая в свою очередь принимает список списков кнопок, которые создаются функцией <code><a href="https://rdrr.io/pkg/telegram.bot/man/KeyboardButton.html">KeyboardButton()</a></code>.</p>
<p>Почему в <code><a href="https://rdrr.io/pkg/telegram.bot/man/ReplyKeyboardMarkup.html">ReplyKeyboardMarkup()</a></code> необходимо передавать не просто список, а список списков? Дело в том, что вы передаёте основной список, и в нём отдельными списками вы задаёте каждый ряд кнопок, т.к. в один ряд можно расположить несколько кнопок.</p>
<p>Аргумент <code>resize_keyboard</code> позволяет автоматически подбирать оптимальный размер кнопок клавиатуры, а аргумент <code>one_time_keyboard</code> позволяет скрывать клавиатуру после каждого нажатия на кнопку.</p>
<p>Давайте напишем простейшего бота, у которого будет 3 кнопки:
* Чат ID - Запросить чат ID диалога с ботом
* Моё имя - Запросить своё имя
* Мой логин - Запросить своё имя пользователя в телеграм</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-1" tabindex="-1"></a><span class="fu">library</span>(telegram.bot)</span>
<span id="cb59-2"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-2" tabindex="-1"></a></span>
<span id="cb59-3"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-3" tabindex="-1"></a><span class="co"># создаём экземпляр класса Updater</span></span>
<span id="cb59-4"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-4" tabindex="-1"></a>updater <span class="ot">&lt;-</span> <span class="fu">Updater</span>(<span class="st">'ТОКЕН ВАШЕГО БОТА'</span>)</span>
<span id="cb59-5"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-5" tabindex="-1"></a></span>
<span id="cb59-6"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-6" tabindex="-1"></a><span class="co"># создаём методы</span></span>
<span id="cb59-7"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-7" tabindex="-1"></a><span class="do">## метод для запуска клавиатуры</span></span>
<span id="cb59-8"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-8" tabindex="-1"></a>start <span class="ot">&lt;-</span> <span class="cf">function</span>(bot, update) {</span>
<span id="cb59-9"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-9" tabindex="-1"></a></span>
<span id="cb59-10"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-10" tabindex="-1"></a>  <span class="co"># создаём клавиатуру</span></span>
<span id="cb59-11"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-11" tabindex="-1"></a>  RKM <span class="ot">&lt;-</span> <span class="fu">ReplyKeyboardMarkup</span>(</span>
<span id="cb59-12"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-12" tabindex="-1"></a>    <span class="at">keyboard =</span> <span class="fu">list</span>(</span>
<span id="cb59-13"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-13" tabindex="-1"></a>      <span class="fu">list</span>(<span class="fu">KeyboardButton</span>(<span class="st">"Чат ID"</span>)),</span>
<span id="cb59-14"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-14" tabindex="-1"></a>      <span class="fu">list</span>(<span class="fu">KeyboardButton</span>(<span class="st">"Моё имя"</span>)),</span>
<span id="cb59-15"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-15" tabindex="-1"></a>      <span class="fu">list</span>(<span class="fu">KeyboardButton</span>(<span class="st">"Мой логин"</span>))</span>
<span id="cb59-16"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-16" tabindex="-1"></a>    ),</span>
<span id="cb59-17"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-17" tabindex="-1"></a>    <span class="at">resize_keyboard =</span> <span class="cn">FALSE</span>,</span>
<span id="cb59-18"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-18" tabindex="-1"></a>    <span class="at">one_time_keyboard =</span> <span class="cn">TRUE</span></span>
<span id="cb59-19"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-19" tabindex="-1"></a>  )</span>
<span id="cb59-20"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-20" tabindex="-1"></a></span>
<span id="cb59-21"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-21" tabindex="-1"></a>  <span class="co"># отправляем клавиатуру</span></span>
<span id="cb59-22"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-22" tabindex="-1"></a>  bot<span class="sc">$</span><span class="fu">sendMessage</span>(update<span class="sc">$</span><span class="fu">from_chat_id</span>(),</span>
<span id="cb59-23"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-23" tabindex="-1"></a>                  <span class="at">text =</span> <span class="st">'Выберите команду'</span>,</span>
<span id="cb59-24"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-24" tabindex="-1"></a>                  <span class="at">reply_markup =</span> RKM)</span>
<span id="cb59-25"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-25" tabindex="-1"></a></span>
<span id="cb59-26"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-26" tabindex="-1"></a>}</span>
<span id="cb59-27"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-27" tabindex="-1"></a></span>
<span id="cb59-28"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-28" tabindex="-1"></a><span class="do">## метод возвразающий id чата</span></span>
<span id="cb59-29"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-29" tabindex="-1"></a>chat_id <span class="ot">&lt;-</span> <span class="cf">function</span>(bot, update) {</span>
<span id="cb59-30"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-30" tabindex="-1"></a></span>
<span id="cb59-31"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-31" tabindex="-1"></a>  bot<span class="sc">$</span><span class="fu">sendMessage</span>(update<span class="sc">$</span><span class="fu">from_chat_id</span>(),</span>
<span id="cb59-32"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-32" tabindex="-1"></a>                  <span class="at">text =</span> <span class="fu">paste0</span>(<span class="st">"Чат id этого диалога: "</span>, update<span class="sc">$</span><span class="fu">from_chat_id</span>()),</span>
<span id="cb59-33"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-33" tabindex="-1"></a>                  <span class="at">parse_mode =</span> <span class="st">"Markdown"</span>)</span>
<span id="cb59-34"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-34" tabindex="-1"></a></span>
<span id="cb59-35"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-35" tabindex="-1"></a>}</span>
<span id="cb59-36"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-36" tabindex="-1"></a></span>
<span id="cb59-37"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-37" tabindex="-1"></a><span class="do">## метод возвращающий имя</span></span>
<span id="cb59-38"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-38" tabindex="-1"></a>my_name <span class="ot">&lt;-</span> <span class="cf">function</span>(bot, update) {</span>
<span id="cb59-39"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-39" tabindex="-1"></a></span>
<span id="cb59-40"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-40" tabindex="-1"></a>  bot<span class="sc">$</span><span class="fu">sendMessage</span>(update<span class="sc">$</span><span class="fu">from_chat_id</span>(),</span>
<span id="cb59-41"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-41" tabindex="-1"></a>                  <span class="at">text =</span> <span class="fu">paste0</span>(<span class="st">"Вас зовут "</span>, update<span class="sc">$</span><span class="fu">effective_user</span>()<span class="sc">$</span>first_name),</span>
<span id="cb59-42"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-42" tabindex="-1"></a>                  <span class="at">parse_mode =</span> <span class="st">"Markdown"</span>)</span>
<span id="cb59-43"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-43" tabindex="-1"></a></span>
<span id="cb59-44"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-44" tabindex="-1"></a>}</span>
<span id="cb59-45"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-45" tabindex="-1"></a></span>
<span id="cb59-46"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-46" tabindex="-1"></a><span class="do">## метод возвращающий логин</span></span>
<span id="cb59-47"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-47" tabindex="-1"></a>my_username <span class="ot">&lt;-</span> <span class="cf">function</span>(bot, update) {</span>
<span id="cb59-48"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-48" tabindex="-1"></a></span>
<span id="cb59-49"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-49" tabindex="-1"></a>  bot<span class="sc">$</span><span class="fu">sendMessage</span>(update<span class="sc">$</span><span class="fu">from_chat_id</span>(),</span>
<span id="cb59-50"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-50" tabindex="-1"></a>                  <span class="at">text =</span> <span class="fu">paste0</span>(<span class="st">"Ваш логин "</span>, update<span class="sc">$</span><span class="fu">effective_user</span>()<span class="sc">$</span>username),</span>
<span id="cb59-51"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-51" tabindex="-1"></a>                  <span class="at">parse_mode =</span> <span class="st">"Markdown"</span>)</span>
<span id="cb59-52"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-52" tabindex="-1"></a></span>
<span id="cb59-53"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-53" tabindex="-1"></a>}</span>
<span id="cb59-54"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-54" tabindex="-1"></a></span>
<span id="cb59-55"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-55" tabindex="-1"></a><span class="co"># создаём фильтры</span></span>
<span id="cb59-56"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-56" tabindex="-1"></a><span class="do">## сообщения с текстом Чат ID</span></span>
<span id="cb59-57"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-57" tabindex="-1"></a>MessageFilters<span class="sc">$</span>chat_id <span class="ot">&lt;-</span> <span class="fu">BaseFilter</span>(<span class="cf">function</span>(message) {</span>
<span id="cb59-58"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-58" tabindex="-1"></a></span>
<span id="cb59-59"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-59" tabindex="-1"></a>  <span class="co"># проверяем текст сообщения</span></span>
<span id="cb59-60"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-60" tabindex="-1"></a>  message<span class="sc">$</span>text <span class="sc">==</span> <span class="st">"Чат ID"</span></span>
<span id="cb59-61"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-61" tabindex="-1"></a></span>
<span id="cb59-62"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-62" tabindex="-1"></a>}</span>
<span id="cb59-63"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-63" tabindex="-1"></a>)</span>
<span id="cb59-64"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-64" tabindex="-1"></a></span>
<span id="cb59-65"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-65" tabindex="-1"></a><span class="do">## сообщения с текстом Моё имя</span></span>
<span id="cb59-66"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-66" tabindex="-1"></a>MessageFilters<span class="sc">$</span>name <span class="ot">&lt;-</span> <span class="fu">BaseFilter</span>(<span class="cf">function</span>(message) {</span>
<span id="cb59-67"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-67" tabindex="-1"></a></span>
<span id="cb59-68"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-68" tabindex="-1"></a>  <span class="co"># проверяем текст сообщения</span></span>
<span id="cb59-69"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-69" tabindex="-1"></a>  message<span class="sc">$</span>text <span class="sc">==</span> <span class="st">"Моё имя"</span></span>
<span id="cb59-70"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-70" tabindex="-1"></a></span>
<span id="cb59-71"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-71" tabindex="-1"></a>}</span>
<span id="cb59-72"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-72" tabindex="-1"></a>)</span>
<span id="cb59-73"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-73" tabindex="-1"></a></span>
<span id="cb59-74"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-74" tabindex="-1"></a><span class="do">## сообщения с текстом Мой логин</span></span>
<span id="cb59-75"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-75" tabindex="-1"></a>MessageFilters<span class="sc">$</span>username <span class="ot">&lt;-</span> <span class="fu">BaseFilter</span>(<span class="cf">function</span>(message) {</span>
<span id="cb59-76"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-76" tabindex="-1"></a></span>
<span id="cb59-77"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-77" tabindex="-1"></a>  <span class="co"># проверяем текст сообщения</span></span>
<span id="cb59-78"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-78" tabindex="-1"></a>  message<span class="sc">$</span>text <span class="sc">==</span> <span class="st">"Мой логин"</span></span>
<span id="cb59-79"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-79" tabindex="-1"></a><span class="er">)</span></span>
<span id="cb59-80"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-80" tabindex="-1"></a></span>
<span id="cb59-81"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-81" tabindex="-1"></a><span class="co"># создаём обработчики</span></span>
<span id="cb59-82"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-82" tabindex="-1"></a>h_start    <span class="ot">&lt;-</span> <span class="fu">CommandHandler</span>(<span class="st">'start'</span>, start)</span>
<span id="cb59-83"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-83" tabindex="-1"></a>h_chat_id  <span class="ot">&lt;-</span> <span class="fu">MessageHandler</span>(chat_id, <span class="at">filters =</span> MessageFilters<span class="sc">$</span>chat_id)</span>
<span id="cb59-84"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-84" tabindex="-1"></a>h_name     <span class="ot">&lt;-</span> <span class="fu">MessageHandler</span>(my_name, <span class="at">filters =</span> MessageFilters<span class="sc">$</span>name)</span>
<span id="cb59-85"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-85" tabindex="-1"></a>h_username <span class="ot">&lt;-</span> <span class="fu">MessageHandler</span>(my_username, <span class="at">filters =</span> MessageFilters<span class="sc">$</span>username)</span>
<span id="cb59-86"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-86" tabindex="-1"></a></span>
<span id="cb59-87"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-87" tabindex="-1"></a><span class="co"># добавляем обработчики в диспетчер</span></span>
<span id="cb59-88"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-88" tabindex="-1"></a>updater <span class="ot">&lt;-</span> updater <span class="sc">+</span></span>
<span id="cb59-89"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-89" tabindex="-1"></a>            h_start <span class="sc">+</span></span>
<span id="cb59-90"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-90" tabindex="-1"></a>            h_chat_id <span class="sc">+</span></span>
<span id="cb59-91"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-91" tabindex="-1"></a>            h_name <span class="sc">+</span></span>
<span id="cb59-92"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-92" tabindex="-1"></a>            h_username</span>
<span id="cb59-93"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-93" tabindex="-1"></a></span>
<span id="cb59-94"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-94" tabindex="-1"></a><span class="co"># запускаем бота</span></span>
<span id="cb59-95"><a href="%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B.html#cb59-95" tabindex="-1"></a>updater<span class="sc">$</span><span class="fu">start_polling</span>()</span></code></pre></div>
<blockquote>
<p>Запустите приведённый выше пример кода, предварительно заменив ‘ТОКЕН ВАШЕГО БОТА’ на реальный токен, который вы получили при создании бота через <em>BotFather</em>.</p>
</blockquote>
<p>После запуска задайте боту команду <code>/start</code>, т.к. именно её мы определили для запуска клавиатуры.</p>
<div class="inline-figure"><img src="https://img.netpeak.ua/alsey/159860932526_kiss_163kb.png"></div>
<p>Если на данный момент вам сложно разобрать приведённый пример кода, с созданием методов, фильтров и обработчиков, то следует вернуться к предыдущей главе, в которой я подробно всё это описал.</p>
<p>Мы создали 4 метода:</p>
<ul>
<li>start - Запуск клавиатуры</li>
<li>chat_id - Запрос идентификатора чата</li>
<li>my_name - Запрос своего имени</li>
<li>my_username - Запрос своего логина</li>
</ul>
<p>В объект <em>MessageFilters</em> добавили 3 фильтра сообщений, по их тексту:</p>
<ul>
<li>chat_id - Сообщения с текстом <code>"Чат ID"</code>
</li>
<li>name - Сообщения с текстом <code>"Моё имя"</code>
</li>
<li>username - Сообщения с текстом <code>"Мой логин"</code>
</li>
</ul>
<p>И создали 4 обработчика, которые по заданным командам и фильтрам будут выполнять указанные методы.</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># создаём обработчики</span></span>
<span><span class="va">h_start</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/CommandHandler.html">CommandHandler</a></span><span class="op">(</span><span class="st">'start'</span>, <span class="va">start</span><span class="op">)</span></span>
<span><span class="va">h_chat_id</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/MessageHandler.html">MessageHandler</a></span><span class="op">(</span><span class="va">chat_id</span>, filters <span class="op">=</span> <span class="va">MessageFilters</span><span class="op">$</span><span class="va">chat_id</span><span class="op">)</span></span>
<span><span class="va">h_name</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/MessageHandler.html">MessageHandler</a></span><span class="op">(</span><span class="va">my_name</span>, filters <span class="op">=</span> <span class="va">MessageFilters</span><span class="op">$</span><span class="va">name</span><span class="op">)</span></span>
<span><span class="va">h_username</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/MessageHandler.html">MessageHandler</a></span><span class="op">(</span><span class="va">my_username</span>, filters <span class="op">=</span> <span class="va">MessageFilters</span><span class="op">$</span><span class="va">username</span><span class="op">)</span></span></code></pre></div>
<p>Сама клавиатура создаётся внутри метода <code><a href="https://rdrr.io/r/stats/start.html">start()</a></code> командой <code><a href="https://rdrr.io/pkg/telegram.bot/man/ReplyKeyboardMarkup.html">ReplyKeyboardMarkup()</a></code>.</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">RKM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/ReplyKeyboardMarkup.html">ReplyKeyboardMarkup</a></span><span class="op">(</span></span>
<span>    keyboard <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/KeyboardButton.html">KeyboardButton</a></span><span class="op">(</span><span class="st">"Чат ID"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/KeyboardButton.html">KeyboardButton</a></span><span class="op">(</span><span class="st">"Моё имя"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/KeyboardButton.html">KeyboardButton</a></span><span class="op">(</span><span class="st">"Мой логин"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    resize_keyboard <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    one_time_keyboard <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>В нашем случае все кнопки мы расположили друг под другом, но мы можем расположить их в один ряд, внеся изменения в список списков кнопок. Т.к. один ряд внутри клавиатуры создаётся через вложенный список кнопок, то для того, что бы вывести наши кнопки в один ряд надо переписать часть кода по построению клавиатуры вот так:</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">RKM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/ReplyKeyboardMarkup.html">ReplyKeyboardMarkup</a></span><span class="op">(</span></span>
<span>    keyboard <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>          <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/KeyboardButton.html">KeyboardButton</a></span><span class="op">(</span><span class="st">"Чат ID"</span><span class="op">)</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/KeyboardButton.html">KeyboardButton</a></span><span class="op">(</span><span class="st">"Моё имя"</span><span class="op">)</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/KeyboardButton.html">KeyboardButton</a></span><span class="op">(</span><span class="st">"Мой логин"</span><span class="op">)</span></span>
<span>     <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    resize_keyboard <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    one_time_keyboard <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="http://img.netpeak.ua/alsey/159861075655_kiss_153kb.png"></div>
<p>Отправляется клавиатура в чат методом <code>sendMessage()</code>, в аргументе <code>reply_markup</code>.</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">bot</span><span class="op">$</span><span class="fu">sendMessage</span><span class="op">(</span><span class="va">update</span><span class="op">$</span><span class="fu">from_chat_id</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                  text <span class="op">=</span> <span class="st">'Выберите команду'</span>,</span>
<span>                  reply_markup <span class="op">=</span> <span class="va">RKM</span><span class="op">)</span></span></code></pre></div>
<div id="как-запросить-у-пользователя-номер-телефона-и-локацию" class="section level3" number="3.3.1">
<h3>
<span class="header-section-number">3.3.1</span> Как запросить у пользователя номер телефона и локацию<a class="anchor" aria-label="anchor" href="#%D0%BA%D0%B0%D0%BA-%D0%B7%D0%B0%D0%BF%D1%80%D0%BE%D1%81%D0%B8%D1%82%D1%8C-%D1%83-%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8F-%D0%BD%D0%BE%D0%BC%D0%B5%D1%80-%D1%82%D0%B5%D0%BB%D0%B5%D1%84%D0%BE%D0%BD%D0%B0-%D0%B8-%D0%BB%D0%BE%D0%BA%D0%B0%D1%86%D0%B8%D1%8E"><i class="fas fa-link"></i></a>
</h3>
<p>При создании кнопок Reply клавиатуры мы используем функцию <code><a href="https://rdrr.io/pkg/telegram.bot/man/KeyboardButton.html">KeyboardButton()</a></code>, у которой доступны 2 дополнительные аргумента:</p>
<ul>
<li>
<code>request_contact</code> - Запросить номер телефона пользователя</li>
<li>
<code>request_location</code> - Запросить локацию пользователя</li>
</ul>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/Bot.html">Bot</a></span><span class="op">(</span>token <span class="op">=</span> <span class="st">"ТОКЕН ВАШЕГО БОТА"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">chat_id</span> <span class="op">&lt;-</span> <span class="st">"ID ВАШЕГО ЧАТА"</span></span>
<span></span>
<span><span class="co"># Create Custom Keyboard</span></span>
<span><span class="va">text</span> <span class="op">&lt;-</span> <span class="st">"Поделитесь своими данными"</span></span>
<span></span>
<span><span class="va">RKM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/ReplyKeyboardMarkup.html">ReplyKeyboardMarkup</a></span><span class="op">(</span></span>
<span>  keyboard <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/KeyboardButton.html">KeyboardButton</a></span><span class="op">(</span><span class="st">"Поделиться номером телефона"</span>, request_contact <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/KeyboardButton.html">KeyboardButton</a></span><span class="op">(</span><span class="st">"Поделиться местонахождением"</span>, request_location <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  resize_keyboard <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  one_time_keyboard <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Send Custom Keyboard</span></span>
<span><span class="va">bot</span><span class="op">$</span><span class="fu">sendMessage</span><span class="op">(</span><span class="va">chat_id</span>, <span class="va">text</span>, reply_markup <span class="op">=</span> <span class="va">RKM</span><span class="op">)</span></span></code></pre></div>
<p>Когда пользователь поделиться с ботом контактами, то в принятом от бота обновлении, в сообщении будет раздел <code>contact</code> со следующими данными:</p>
<ul>
<li>phone_number - номер телефона в международном формате</li>
<li>first_name - Имя</li>
<li>last_name - Фамилия</li>
<li>user_id - Внутренний идентификатор пользователя в telegram</li>
</ul>
<p>Когда пользователь делиться местонахождением то в сообщении полученного ответа будет раздел <code>location</code> с информацией о координатах местонахождения пользователя, т.е. широта и долгота.</p>
</div>
</div>
<div id="inline-клавиатура" class="section level2" number="3.4">
<h2>
<span class="header-section-number">3.4</span> Inline клавиатура<a class="anchor" aria-label="anchor" href="#inline-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D0%B0"><i class="fas fa-link"></i></a>
</h2>
<p>Как я уже писал выше, Inline клавиатура привязана к конкретному сообщению. С ней работать несколько сложнее чем с основной клавиатурой.</p>
<p>Изначально вам необходимо добавить боту метод, для вызова Inline клавиатуры.</p>
<p>Для ответа на нажатие Inline кнопки также можно использовать метод бота <code>answerCallbackQuery()</code>, который может вывести уведомление в интерфейсе telegram, пользователю нажавшему Inline кнопку.</p>
<p>Данные отправленные с Inline кнопки не являются текстом, поэтому для их обработки необходимо создать специальный обработчик с помощью команды <code><a href="https://rdrr.io/pkg/telegram.bot/man/CallbackQueryHandler.html">CallbackQueryHandler()</a></code>.</p>
<p>Код построения Inline клавиатуры который приводится в официальной справке пакета <code>telegram.bot</code>.</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Initialize bot</span></span>
<span><span class="va">bot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/Bot.html">Bot</a></span><span class="op">(</span>token <span class="op">=</span> <span class="st">"TOKEN"</span><span class="op">)</span></span>
<span><span class="va">chat_id</span> <span class="op">&lt;-</span> <span class="st">"CHAT_ID"</span></span>
<span></span>
<span><span class="co"># Create Inline Keyboard</span></span>
<span><span class="va">text</span> <span class="op">&lt;-</span> <span class="st">"Could you type their phone number, please?"</span></span>
<span><span class="va">IKM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardMarkup.html">InlineKeyboardMarkup</a></span><span class="op">(</span></span>
<span>  inline_keyboard <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardButton.html">InlineKeyboardButton</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardButton.html">InlineKeyboardButton</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardButton.html">InlineKeyboardButton</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardButton.html">InlineKeyboardButton</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardButton.html">InlineKeyboardButton</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardButton.html">InlineKeyboardButton</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardButton.html">InlineKeyboardButton</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardButton.html">InlineKeyboardButton</a></span><span class="op">(</span><span class="fl">8</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardButton.html">InlineKeyboardButton</a></span><span class="op">(</span><span class="fl">9</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardButton.html">InlineKeyboardButton</a></span><span class="op">(</span><span class="st">"*"</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardButton.html">InlineKeyboardButton</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardButton.html">InlineKeyboardButton</a></span><span class="op">(</span><span class="st">"#"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Send Inline Keyboard</span></span>
<span><span class="va">bot</span><span class="op">$</span><span class="fu">sendMessage</span><span class="op">(</span><span class="va">chat_id</span>, <span class="va">text</span>, reply_markup <span class="op">=</span> <span class="va">IKM</span><span class="op">)</span></span></code></pre></div>
<p>Строить Inline клавиатуру необходимо с помощью команды <code><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardMarkup.html">InlineKeyboardMarkup()</a></code>, по такому же принципу, как и Reply клавиатуру. В <code><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardMarkup.html">InlineKeyboardMarkup()</a></code> необходимо передать список, списков Inline кнопок, каждая отдельная кнопка создаётся функцией <code><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardButton.html">InlineKeyboardButton()</a></code>.</p>
<p>Inline кнопка может либо передавать боту какие-то данные с помощью аргумента <code>callback_data</code>, либо открывать какую-либо HTML страницу, заданную с помощью аргумента <code>url</code>.</p>
<p>В результате будет список, в котором каждый элемент так же является списком Inline кнопок, которые необходимо объединить в один ряд.</p>
<p>Далее мы рассмотрим несколько примеров ботов с Inline кнопками.</p>
<div id="пример-простейшего-бота-с-поддержкой-inline-кнопок" class="section level3" number="3.4.1">
<h3>
<span class="header-section-number">3.4.1</span> Пример простейшего бота с поддержкой InLine кнопок<a class="anchor" aria-label="anchor" href="#%D0%BF%D1%80%D0%B8%D0%BC%D0%B5%D1%80-%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%B5%D0%B9%D1%88%D0%B5%D0%B3%D0%BE-%D0%B1%D0%BE%D1%82%D0%B0-%D1%81-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D0%BE%D0%B9-inline-%D0%BA%D0%BD%D0%BE%D0%BF%D0%BE%D0%BA"><i class="fas fa-link"></i></a>
</h3>
<p>Для начала мы напишем бота для экспресс тестирования на covid-19. По команде <code>/test</code>, он будет отправлять вам клавиатуру с двумя кнопками, в зависимости от нажатой кнопки он будет присылать вам сообщение с результатами вашего тестирования.</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ebeneditos/telegram.bot">telegram.bot</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># создаём экземпляр класса Updater</span></span>
<span><span class="va">updater</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/Updater.html">Updater</a></span><span class="op">(</span><span class="st">'ТОКЕН ВАШЕГО БОТА'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># метод для отправки InLine клавиатуры</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">bot</span>, <span class="va">update</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span></span>
<span>  <span class="co"># создаём InLine клавиатуру</span></span>
<span>  <span class="va">IKM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardMarkup.html">InlineKeyboardMarkup</a></span><span class="op">(</span></span>
<span>    inline_keyboard <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardButton.html">InlineKeyboardButton</a></span><span class="op">(</span><span class="st">"Да"</span>, callback_data <span class="op">=</span> <span class="st">'yes'</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardButton.html">InlineKeyboardButton</a></span><span class="op">(</span><span class="st">"Нет"</span>, callback_data <span class="op">=</span> <span class="st">'no'</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Отправляем клавиатуру в чат</span></span>
<span>  <span class="va">bot</span><span class="op">$</span><span class="fu">sendMessage</span><span class="op">(</span><span class="va">update</span><span class="op">$</span><span class="fu">from_chat_id</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                  text <span class="op">=</span> <span class="st">"Вы болете коронавирусом?"</span>,</span>
<span>                  reply_markup <span class="op">=</span> <span class="va">IKM</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># метод для обработки нажатия кнопки</span></span>
<span><span class="va">answer_cb</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">bot</span>, <span class="va">update</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="co"># полученные данные с кнопки</span></span>
<span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="va">update</span><span class="op">$</span><span class="va">callback_query</span><span class="op">$</span><span class="va">data</span></span>
<span></span>
<span>  <span class="co"># получаем имя пользователя, нажавшего кнопку</span></span>
<span>  <span class="va">uname</span> <span class="op">&lt;-</span> <span class="va">update</span><span class="op">$</span><span class="fu">effective_user</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">first_name</span></span>
<span></span>
<span>  <span class="co"># обработка результата</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span> <span class="va">data</span> <span class="op">==</span> <span class="st">'no'</span> <span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>    <span class="va">msg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">uname</span>, <span class="st">", поздравляю, ваш тест на covid-19 отрицательный."</span><span class="op">)</span></span>
<span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span></span>
<span>    <span class="va">msg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">uname</span>, <span class="st">", к сожалени ваш тест на covid-19 положительный."</span><span class="op">)</span></span>
<span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span></span>
<span>  <span class="co"># Отправка сообщения</span></span>
<span>  <span class="va">bot</span><span class="op">$</span><span class="fu">sendMessage</span><span class="op">(</span>chat_id <span class="op">=</span> <span class="va">update</span><span class="op">$</span><span class="fu">from_chat_id</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                  text <span class="op">=</span> <span class="va">msg</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># сообщаем боту, что запрос с кнопки принят</span></span>
<span>  <span class="va">bot</span><span class="op">$</span><span class="fu">answerCallbackQuery</span><span class="op">(</span>callback_query_id <span class="op">=</span> <span class="va">update</span><span class="op">$</span><span class="va">callback_query</span><span class="op">$</span><span class="va">id</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># создаём обработчики</span></span>
<span><span class="va">inline_h</span>      <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/CommandHandler.html">CommandHandler</a></span><span class="op">(</span><span class="st">'test'</span>, <span class="va">test</span><span class="op">)</span></span>
<span><span class="va">query_handler</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/CallbackQueryHandler.html">CallbackQueryHandler</a></span><span class="op">(</span><span class="va">answer_cb</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># добавляем обработчики в диспетчер</span></span>
<span><span class="va">updater</span> <span class="op">&lt;-</span> <span class="va">updater</span> <span class="op">+</span> <span class="va">inline_h</span> <span class="op">+</span> <span class="va">query_handler</span></span>
<span></span>
<span><span class="co"># запускаем бота</span></span>
<span><span class="va">updater</span><span class="op">$</span><span class="fu">start_polling</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<blockquote>
<p>Запустите приведённый выше пример кода, предварительно заменив ‘ТОКЕН ВАШЕГО БОТА’ на реальный токен, который вы получили при создании бота через <em>BotFather</em>.</p>
</blockquote>
<div class="inline-figure">Результат:
<img src="https://img.netpeak.ua/alsey/159912494522_kiss_227kb.png">
</div>
<p>Мы создали два метода:</p>
<ul>
<li>
<em>test</em> - Для отправки в чат Inline клавиатуры</li>
<li>
<em>answer_cb</em> - Для обработки отправленных с клавиатуры данных.</li>
</ul>
<p>Данные, которые будут отправлены с каждой кнопки задаются в аргументе <code>callback_data</code>, при создании кнопки. Получить отправленные с кнопки данные можно с помощью конструкции <code>update$callback_query$data</code>, внутри метода <em>answer_cb</em>.</p>
<p>Что бы бот реагировал на Inline клавиатуру, метод <em>answer_cb</em> обрабатывается специальным обработчиком: <code>CallbackQueryHandler(answer_cb)</code>. Который запускает указанный метод по нажатию Inline кнопки. Обработчик <strong>CallbackQueryHandler</strong> принимает два аргумента:</p>
<ul>
<li>
<code>callback</code> - Метод который необходимо запустить</li>
<li>
<code>pattern</code> - Фильтр по данным, которые привязаны к кнопке с помощью аргумента <code>callback_data</code>.</li>
</ul>
<p>Соответвенно с помощью аргумента <code>pattern</code> мы можем под нажатие каждой кнопки написать отдельный метод:</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ebeneditos/telegram.bot">telegram.bot</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># создаём экземпляр класса Updater</span></span>
<span><span class="va">updater</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/Updater.html">Updater</a></span><span class="op">(</span><span class="st">'ТОКЕН ВАШЕГО БОТА'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># метод для отправки InLine клавиатуры</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">bot</span>, <span class="va">update</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="co"># создаём InLine клавиатуру</span></span>
<span>  <span class="va">IKM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardMarkup.html">InlineKeyboardMarkup</a></span><span class="op">(</span></span>
<span>    inline_keyboard <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardButton.html">InlineKeyboardButton</a></span><span class="op">(</span><span class="st">"Да"</span>, callback_data <span class="op">=</span> <span class="st">'yes'</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardButton.html">InlineKeyboardButton</a></span><span class="op">(</span><span class="st">"Нет"</span>, callback_data <span class="op">=</span> <span class="st">'no'</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Отправляем клавиатуру в чат</span></span>
<span>  <span class="va">bot</span><span class="op">$</span><span class="fu">sendMessage</span><span class="op">(</span><span class="va">update</span><span class="op">$</span><span class="fu">from_chat_id</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                  text <span class="op">=</span> <span class="st">"Вы болете коронавирусом?"</span>,</span>
<span>                  reply_markup <span class="op">=</span> <span class="va">IKM</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># метод для обработки нажатия кнопки Да</span></span>
<span><span class="va">answer_cb_yes</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">bot</span>, <span class="va">update</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="co"># получаем имя пользователя, нажавшего кнопку</span></span>
<span>  <span class="va">uname</span> <span class="op">&lt;-</span> <span class="va">update</span><span class="op">$</span><span class="fu">effective_user</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">first_name</span></span>
<span></span>
<span>  <span class="co"># обработка результата</span></span>
<span>  <span class="va">msg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">uname</span>, <span class="st">", к сожалени ваш текст на covid-19 положительный."</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Отправка сообщения</span></span>
<span>  <span class="va">bot</span><span class="op">$</span><span class="fu">sendMessage</span><span class="op">(</span>chat_id <span class="op">=</span> <span class="va">update</span><span class="op">$</span><span class="fu">from_chat_id</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                  text <span class="op">=</span> <span class="va">msg</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># сообщаем боту, что запрос с кнопки принят</span></span>
<span>  <span class="va">bot</span><span class="op">$</span><span class="fu">answerCallbackQuery</span><span class="op">(</span>callback_query_id <span class="op">=</span> <span class="va">update</span><span class="op">$</span><span class="va">callback_query</span><span class="op">$</span><span class="va">id</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># метод для обработки нажатия кнопки Нет</span></span>
<span><span class="va">answer_cb_no</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">bot</span>, <span class="va">update</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="co"># получаем имя пользователя, нажавшего кнопку</span></span>
<span>  <span class="va">uname</span> <span class="op">&lt;-</span> <span class="va">update</span><span class="op">$</span><span class="fu">effective_user</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">first_name</span></span>
<span></span>
<span>  <span class="va">msg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">uname</span>, <span class="st">", поздравляю, ваш текст на covid-19 отрицательный."</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Отправка сообщения</span></span>
<span>  <span class="va">bot</span><span class="op">$</span><span class="fu">sendMessage</span><span class="op">(</span>chat_id <span class="op">=</span> <span class="va">update</span><span class="op">$</span><span class="fu">from_chat_id</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                  text <span class="op">=</span> <span class="va">msg</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># сообщаем боту, что запрос с кнопки принят</span></span>
<span>  <span class="va">bot</span><span class="op">$</span><span class="fu">answerCallbackQuery</span><span class="op">(</span>callback_query_id <span class="op">=</span> <span class="va">update</span><span class="op">$</span><span class="va">callback_query</span><span class="op">$</span><span class="va">id</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># создаём обработчики</span></span>
<span><span class="va">inline_h</span>          <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/CommandHandler.html">CommandHandler</a></span><span class="op">(</span><span class="st">'test'</span>, <span class="va">test</span><span class="op">)</span></span>
<span><span class="va">query_handler_yes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/CallbackQueryHandler.html">CallbackQueryHandler</a></span><span class="op">(</span><span class="va">answer_cb_yes</span>, pattern <span class="op">=</span> <span class="st">'yes'</span><span class="op">)</span></span>
<span><span class="va">query_handler_no</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/CallbackQueryHandler.html">CallbackQueryHandler</a></span><span class="op">(</span><span class="va">answer_cb_no</span>, pattern <span class="op">=</span> <span class="st">'no'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># добавляем обработчики в диспетчер</span></span>
<span><span class="va">updater</span> <span class="op">&lt;-</span> <span class="va">updater</span> <span class="op">+</span></span>
<span>            <span class="va">inline_h</span> <span class="op">+</span></span>
<span>            <span class="va">query_handler_yes</span> <span class="op">+</span></span>
<span>            <span class="va">query_handler_no</span></span>
<span></span>
<span><span class="co"># запускаем бота</span></span>
<span><span class="va">updater</span><span class="op">$</span><span class="fu">start_polling</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<blockquote>
<p>Запустите приведённый выше пример кода, предварительно заменив ‘ТОКЕН ВАШЕГО БОТА’ на реальный токен, который вы получили при создании бота через <em>BotFather</em>.</p>
</blockquote>
<p>Теперь мы написали 2 отдельных метода, т.е. по одному методу, под нажатие каждой кнопки, и использовали аргумент <code>pattern</code>, при создании их обработчиков:</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">query_handler_yes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/CallbackQueryHandler.html">CallbackQueryHandler</a></span><span class="op">(</span><span class="va">answer_cb_yes</span>, pattern <span class="op">=</span> <span class="st">'yes'</span><span class="op">)</span></span>
<span><span class="va">query_handler_no</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/CallbackQueryHandler.html">CallbackQueryHandler</a></span><span class="op">(</span><span class="va">answer_cb_no</span>, pattern <span class="op">=</span> <span class="st">'no'</span><span class="op">)</span></span></code></pre></div>
<p>Заканчивается код метода <em>answer_cb</em> командой <code>bot$answerCallbackQuery(callback_query_id = update$callback_query$id)</code>, которая сообщает боту, что данные с inline клавиатуры получены.</p>
</div>
<div id="пример-бота-который-сообщает-текущую-погоду-по-выбранному-городу" class="section level3" number="3.4.2">
<h3>
<span class="header-section-number">3.4.2</span> Пример бота, который сообщает текущую погоду по выбранному городу<a class="anchor" aria-label="anchor" href="#%D0%BF%D1%80%D0%B8%D0%BC%D0%B5%D1%80-%D0%B1%D0%BE%D1%82%D0%B0-%D0%BA%D0%BE%D1%82%D0%BE%D1%80%D1%8B%D0%B9-%D1%81%D0%BE%D0%BE%D0%B1%D1%89%D0%B0%D0%B5%D1%82-%D1%82%D0%B5%D0%BA%D1%83%D1%89%D1%83%D1%8E-%D0%BF%D0%BE%D0%B3%D0%BE%D0%B4%D1%83-%D0%BF%D0%BE-%D0%B2%D1%8B%D0%B1%D1%80%D0%B0%D0%BD%D0%BD%D0%BE%D0%BC%D1%83-%D0%B3%D0%BE%D1%80%D0%BE%D0%B4%D1%83"><i class="fas fa-link"></i></a>
</h3>
<p>Давайте попробуем написать бота, который запрашивает данные о погоде.</p>
<p>Логика его работы будет следующая. Изначально командой <code>/start</code> вы вызываете основную клавиатуру, в которой присутствует всего одна кнопка “Погода”. Нажав на эту кнопку вы получаете сообщение с Inline клавиатурой, для выбора города, по которому требуется узнать текущую погоду. Выбираете один из городов, и получаете текущую погоду.</p>
<p>В этом примере кода мы будем использовать несколько дополнительных пакетов:</p>
<ul>
<li>
<code>httr</code> - пакет для работы с HTTP запросами, на основе которых построена работа с любым API. В нашем случае мы будем использовать бесплатный API <a href="https://openweathermap.org/api">openweathermap.org</a>.</li>
<li>
<code>stringr</code> - пакет для работы с текстом, в нашем случае мы будем его использовать для формирования сообщения о погоде в выбранном городе.</li>
</ul>
<p><em>Код бота, который сообщает текущую погоду по выбранному городу</em></p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ebeneditos/telegram.bot">telegram.bot</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://httr.r-lib.org/">httr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org">stringr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># создаём экземпляр класса Updater</span></span>
<span><span class="va">updater</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/Updater.html">Updater</a></span><span class="op">(</span><span class="st">'ТОКЕН ВАШЕГО БОТА'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># создаём методы</span></span>
<span><span class="co">## метод для запуска основной клавиатуры</span></span>
<span><span class="va">start</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">bot</span>, <span class="va">update</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="co"># создаём клавиатуру</span></span>
<span>  <span class="va">RKM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/ReplyKeyboardMarkup.html">ReplyKeyboardMarkup</a></span><span class="op">(</span></span>
<span>    keyboard <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/KeyboardButton.html">KeyboardButton</a></span><span class="op">(</span><span class="st">"Погода"</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    resize_keyboard <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    one_time_keyboard <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># отправляем клавиатуру</span></span>
<span>  <span class="va">bot</span><span class="op">$</span><span class="fu">sendMessage</span><span class="op">(</span><span class="va">update</span><span class="op">$</span><span class="fu">from_chat_id</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                  text <span class="op">=</span> <span class="st">'Выберите команду'</span>,</span>
<span>                  reply_markup <span class="op">=</span> <span class="va">RKM</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">## Метод вызова Inine клавиатуры</span></span>
<span><span class="va">weather</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">bot</span>, <span class="va">update</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="va">IKM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardMarkup.html">InlineKeyboardMarkup</a></span><span class="op">(</span></span>
<span>    inline_keyboard <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardButton.html">InlineKeyboardButton</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">'Москва'</span>, callback_data <span class="op">=</span> <span class="st">'New York,us'</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardButton.html">InlineKeyboardButton</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">'Санкт-Петербург'</span>, callback_data <span class="op">=</span> <span class="st">'Saint Petersburg'</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardButton.html">InlineKeyboardButton</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">'Нью-Йорк'</span>, callback_data <span class="op">=</span> <span class="st">'New York'</span><span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardButton.html">InlineKeyboardButton</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">'Екатеринбург'</span>, callback_data <span class="op">=</span> <span class="st">'Yekaterinburg,ru'</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardButton.html">InlineKeyboardButton</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">'Берлин'</span>, callback_data <span class="op">=</span> <span class="st">'Berlin,de'</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardButton.html">InlineKeyboardButton</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">'Париж'</span>, callback_data <span class="op">=</span> <span class="st">'Paris,fr'</span><span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardButton.html">InlineKeyboardButton</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">'Рим'</span>, callback_data <span class="op">=</span> <span class="st">'Rome,it'</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardButton.html">InlineKeyboardButton</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">'Одесса'</span>, callback_data <span class="op">=</span> <span class="st">'Odessa,ua'</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardButton.html">InlineKeyboardButton</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">'Киев'</span>, callback_data <span class="op">=</span> <span class="st">'Kyiv,ua'</span><span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardButton.html">InlineKeyboardButton</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">'Токио'</span>, callback_data <span class="op">=</span> <span class="st">'Tokyo'</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardButton.html">InlineKeyboardButton</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">'Амстердам'</span>, callback_data <span class="op">=</span> <span class="st">'Amsterdam,nl'</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardButton.html">InlineKeyboardButton</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">'Вашингтон'</span>, callback_data <span class="op">=</span> <span class="st">'Washington,us'</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Send Inline Keyboard</span></span>
<span>  <span class="va">bot</span><span class="op">$</span><span class="fu">sendMessage</span><span class="op">(</span>chat_id <span class="op">=</span> <span class="va">update</span><span class="op">$</span><span class="fu">from_chat_id</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                  text <span class="op">=</span> <span class="st">"Выберите город"</span>,</span>
<span>                  reply_markup <span class="op">=</span> <span class="va">IKM</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># метод для сообщения погоды</span></span>
<span><span class="va">answer_cb</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">bot</span>, <span class="va">update</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="co"># получаем из сообщения город</span></span>
<span>  <span class="va">city</span> <span class="op">&lt;-</span> <span class="va">update</span><span class="op">$</span><span class="va">callback_query</span><span class="op">$</span><span class="va">data</span></span>
<span></span>
<span>  <span class="co"># отправляем запрос</span></span>
<span>  <span class="va">ans</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://httr.r-lib.org/reference/GET.html">GET</a></span><span class="op">(</span><span class="st">'https://api.openweathermap.org/data/2.5/weather'</span>,</span>
<span>             query <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>q     <span class="op">=</span> <span class="va">city</span>,</span>
<span>                          lang  <span class="op">=</span> <span class="st">'ru'</span>,</span>
<span>                          units <span class="op">=</span> <span class="st">'metric'</span>,</span>
<span>                          appid <span class="op">=</span> <span class="st">'4776568ccea136ffe4cda9f1969af340'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># парсим ответ</span></span>
<span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://httr.r-lib.org/reference/content.html">content</a></span><span class="op">(</span><span class="va">ans</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># формируем сообщение</span></span>
<span>  <span class="va">msg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_glue.html">str_glue</a></span><span class="op">(</span><span class="st">"{result$name} погода:\n"</span>,</span>
<span>                  <span class="st">"Текущая температура: {result$main$temp}\n"</span>,</span>
<span>                  <span class="st">"Скорость ветра: {result$wind$speed}\n"</span>,</span>
<span>                  <span class="st">"Описание: {result$weather[[1]]$description}"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># отправляем информацию о погоде</span></span>
<span>  <span class="va">bot</span><span class="op">$</span><span class="fu">sendMessage</span><span class="op">(</span>chat_id <span class="op">=</span> <span class="va">update</span><span class="op">$</span><span class="fu">from_chat_id</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                  text    <span class="op">=</span> <span class="va">msg</span><span class="op">)</span></span>
<span></span>
<span></span>
<span>  <span class="va">bot</span><span class="op">$</span><span class="fu">answerCallbackQuery</span><span class="op">(</span>callback_query_id <span class="op">=</span> <span class="va">update</span><span class="op">$</span><span class="va">callback_query</span><span class="op">$</span><span class="va">id</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># создаём фильтры</span></span>
<span><span class="co">## сообщения с текстом Погода</span></span>
<span><span class="va">MessageFilters</span><span class="op">$</span><span class="va">weather</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/BaseFilter.html">BaseFilter</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">message</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="co"># проверяем текст сообщения</span></span>
<span>  <span class="va">message</span><span class="op">$</span><span class="va">text</span> <span class="op">==</span> <span class="st">"Погода"</span></span>
<span></span>
<span><span class="op">}</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># создаём обработчики</span></span>
<span><span class="va">h_start</span>         <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/CommandHandler.html">CommandHandler</a></span><span class="op">(</span><span class="st">'start'</span>, <span class="va">start</span><span class="op">)</span></span>
<span><span class="va">h_weather</span>       <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/MessageHandler.html">MessageHandler</a></span><span class="op">(</span><span class="va">weather</span>, filters <span class="op">=</span> <span class="va">MessageFilters</span><span class="op">$</span><span class="va">weather</span><span class="op">)</span></span>
<span><span class="va">h_query_handler</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/CallbackQueryHandler.html">CallbackQueryHandler</a></span><span class="op">(</span><span class="va">answer_cb</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># добавляем обработчики в диспетчер</span></span>
<span><span class="va">updater</span> <span class="op">&lt;-</span> <span class="va">updater</span> <span class="op">+</span></span>
<span>              <span class="va">h_start</span> <span class="op">+</span></span>
<span>              <span class="va">h_weather</span> <span class="op">+</span></span>
<span>              <span class="va">h_query_handler</span></span>
<span></span>
<span><span class="co"># запускаем бота</span></span>
<span><span class="va">updater</span><span class="op">$</span><span class="fu">start_polling</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p></p>
<blockquote>
<p>Запустите приведённый выше пример кода, предварительно заменив ‘ТОКЕН ВАШЕГО БОТА’ на реальный токен, который вы получили при создании бота через <em>BotFather</em>.</p>
</blockquote>
<div class="inline-figure">В результате наш бот будет работать примерно так:
<img src="https://img.netpeak.ua/alsey/159863902887_kiss_184kb.png">
</div>
<div class="inline-figure">Схематически данного бота можно изобрать вот так:
<img src="http://img.netpeak.ua/alsey/159906484732_kiss_23kb.png">
</div>
<p>Мы создали 3 метода, доступные внутри нашего погодного бота:</p>
<ul>
<li>
<em>start</em> - Запуск основной клавиатуры бота</li>
<li>
<em>weather</em> - Запуск Inline клавиатуры для выбора города</li>
<li>
<em>answer_cb</em> - Основной метод, который по заданному городу запрашивает в API погоду, и отправляет её в чат.</li>
</ul>
<p>Метод <em>start</em> у нас запускается командой <code>/start</code>, что реализовано обработчиком <code>CommandHandler('start', start)</code>.</p>
<p>Для запуска метода <em>weather</em> мы создали одноимённый фильтр:</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># создаём фильтры</span></span>
<span><span class="co">## сообщения с текстом Погода</span></span>
<span><span class="va">MessageFilters</span><span class="op">$</span><span class="va">weather</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/BaseFilter.html">BaseFilter</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">message</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="co"># проверяем текст сообщения</span></span>
<span>  <span class="va">message</span><span class="op">$</span><span class="va">text</span> <span class="op">==</span> <span class="st">"Погода"</span></span>
<span></span>
<span><span class="op">}</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>И вызываем этот метод следующим обработчиком сообщений: <code>MessageHandler(weather, filters = MessageFilters$weather)</code>.</p>
<p>И в конце концов, основной наш метод <em>answer_cb</em> реагирует на нажатие Inline кнопок, что реализовано специальным обработчиком: <code>CallbackQueryHandler(answer_cb)</code>.</p>
<p>Внутри метода <em>answer_cb</em>, мы считываем отправленные с клавиатуры данные и записываем их в переменную <code>city</code>: <code>city &lt;- update$callback_query$data</code>. После чего запрашиваем из API данные о погоде, формируем и отправляем сообщение, и в конце концов используем метод <code>answerCallbackQuery</code> для того, что бы сообщить боту, о том, что мы обработали нажатие Inline кнопки.</p>
</div>
<div id="пример-бота-который-выводит-список-самых-свежих-статей-со-ссылками-по-указанному-хабу-из-habr.com" class="section level3" number="3.4.3">
<h3>
<span class="header-section-number">3.4.3</span> Пример бота, который выводит список самых свежих статей со ссылками по-указанному Хабу из habr.com<a class="anchor" aria-label="anchor" href="#%D0%BF%D1%80%D0%B8%D0%BC%D0%B5%D1%80-%D0%B1%D0%BE%D1%82%D0%B0-%D0%BA%D0%BE%D1%82%D0%BE%D1%80%D1%8B%D0%B9-%D0%B2%D1%8B%D0%B2%D0%BE%D0%B4%D0%B8%D1%82-%D1%81%D0%BF%D0%B8%D1%81%D0%BE%D0%BA-%D1%81%D0%B0%D0%BC%D1%8B%D1%85-%D1%81%D0%B2%D0%B5%D0%B6%D0%B8%D1%85-%D1%81%D1%82%D0%B0%D1%82%D0%B5%D0%B9-%D1%81%D0%BE-%D1%81%D1%81%D1%8B%D0%BB%D0%BA%D0%B0%D0%BC%D0%B8-%D0%BF%D0%BE-%D1%83%D0%BA%D0%B0%D0%B7%D0%B0%D0%BD%D0%BD%D0%BE%D0%BC%D1%83-%D1%85%D0%B0%D0%B1%D1%83-%D0%B8%D0%B7-habr.com"><i class="fas fa-link"></i></a>
</h3>
<p>Данного бота я привожу для того, что бы показать вам, как вывести Inline кнопки которые ведут на веб страницы.</p>
<p>Логика данного бота схожа с предыдущим, изначально мы запускаем основную клавиатуру командой <code>/start</code>. Далее бот даёт нам на выбор список из 6 хабов, мы выбираем интересующий нас хаб, и получаем 5 самых свежих публикаций из выбранного Хаба.</p>
<p>Как вы понимаете, в данном случае нам необходимо получить список статей, и для этого мы будем использовать пакет <code>tidyRSS</code>, который позволяет вам получать RSS feed (ленту) сайта в виде обычного дата фрейма в R, к счастью Хабр предоставляет RSS фид под каждый отдельный хаб.</p>
<blockquote>
<p>RSS — это файл в формате .XML или .RSS, который используют сайты, чтобы передавать пользователю информацию об обновлениях.</p>
</blockquote>
<p>Для начала установим пакет <code>tidyRSS</code>.</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">'`tidyRSS`'</span><span class="op">)</span></span></code></pre></div>
<p>Получить RRS Feed по какому то хабу можно примерно так:</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RobertMyles/tidyrss">tidyRSS</a></span><span class="op">)</span></span>
<span><span class="va">url</span> <span class="op">&lt;-</span> <span class="st">'https://habr.com/ru/rss/hub/r/'</span></span>
<span><span class="va">rss_fead</span> <span class="op">&lt;-</span> <span class="fu">tidyfeed</span><span class="op">(</span><span class="va">url</span><span class="op">)</span></span></code></pre></div>
<p>Теперь рассмотрим код построения описанного выше бота:</p>
<p><em>Код бот который выводит список наиболее свежих статей по выбранному Хабу</em></p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ebeneditos/telegram.bot">telegram.bot</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RobertMyles/tidyrss">tidyRSS</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># создаём экземпляр класса Updater</span></span>
<span><span class="va">updater</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/Updater.html">Updater</a></span><span class="op">(</span><span class="st">'ТОКЕН ВАШЕГО БОТА'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># создаём методы</span></span>
<span><span class="co">## метод для запуска основной клавиатуры</span></span>
<span><span class="va">start</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">bot</span>, <span class="va">update</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="co"># создаём клавиатуру</span></span>
<span>  <span class="va">RKM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/ReplyKeyboardMarkup.html">ReplyKeyboardMarkup</a></span><span class="op">(</span></span>
<span>    keyboard <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/KeyboardButton.html">KeyboardButton</a></span><span class="op">(</span><span class="st">"Список статей"</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    resize_keyboard <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    one_time_keyboard <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># отправляем клавиатуру</span></span>
<span>  <span class="va">bot</span><span class="op">$</span><span class="fu">sendMessage</span><span class="op">(</span><span class="va">update</span><span class="op">$</span><span class="fu">from_chat_id</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                  text <span class="op">=</span> <span class="st">'Выберите команду'</span>,</span>
<span>                  reply_markup <span class="op">=</span> <span class="va">RKM</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">## Метод вызова Inine клавиатуры</span></span>
<span><span class="va">habs</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">bot</span>, <span class="va">update</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">IKM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardMarkup.html">InlineKeyboardMarkup</a></span><span class="op">(</span></span>
<span>    inline_keyboard <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardButton.html">InlineKeyboardButton</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">'R'</span>, callback_data <span class="op">=</span> <span class="st">'r'</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardButton.html">InlineKeyboardButton</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">'Data Mining'</span>, callback_data <span class="op">=</span> <span class="st">'data_mining'</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardButton.html">InlineKeyboardButton</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">'Data Engineering'</span>, callback_data <span class="op">=</span> <span class="st">'data_engineering'</span><span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardButton.html">InlineKeyboardButton</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">'Big Data'</span>, callback_data <span class="op">=</span> <span class="st">'bigdata'</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardButton.html">InlineKeyboardButton</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">'Python'</span>, callback_data <span class="op">=</span> <span class="st">'python'</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardButton.html">InlineKeyboardButton</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">'Визуализация данных'</span>, callback_data <span class="op">=</span> <span class="st">'data_visualization'</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Send Inline Keyboard</span></span>
<span>  <span class="va">bot</span><span class="op">$</span><span class="fu">sendMessage</span><span class="op">(</span>chat_id <span class="op">=</span> <span class="va">update</span><span class="op">$</span><span class="fu">from_chat_id</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                  text <span class="op">=</span> <span class="st">"Выберите Хаб"</span>,</span>
<span>                  reply_markup <span class="op">=</span> <span class="va">IKM</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># метод для сообщения погоды</span></span>
<span><span class="va">answer_cb</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">bot</span>, <span class="va">update</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="co"># получаем из сообщения название хаба</span></span>
<span>  <span class="va">hub</span> <span class="op">&lt;-</span> <span class="va">update</span><span class="op">$</span><span class="va">callback_query</span><span class="op">$</span><span class="va">data</span></span>
<span>  </span>
<span>  <span class="co"># сообщение о том, что данные по кнопке получены</span></span>
<span>  <span class="va">bot</span><span class="op">$</span><span class="fu">answerCallbackQuery</span><span class="op">(</span>callback_query_id <span class="op">=</span> <span class="va">update</span><span class="op">$</span><span class="va">callback_query</span><span class="op">$</span><span class="va">id</span>,</span>
<span>                          text <span class="op">=</span> <span class="st">'Подождите несколько минут, запрос обрабатывается'</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># сообщение о том, что надо подождать пока бот получит данные</span></span>
<span>  <span class="va">mid</span> <span class="op">&lt;-</span> <span class="va">bot</span><span class="op">$</span><span class="fu">sendMessage</span><span class="op">(</span>chat_id <span class="op">=</span> <span class="va">update</span><span class="op">$</span><span class="fu">from_chat_id</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                         text    <span class="op">=</span> <span class="st">"Подождите несколько минут пока, я соберу данные по выбранному Хабу"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># запрашиваем RSS Feed по Хабу</span></span>
<span>  <span class="va">url</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">'https://habr.com/ru/rss/hub/'</span>, <span class="va">hub</span>, <span class="st">'/'</span><span class="op">)</span></span>
<span>  <span class="va">posts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu">tidyfeed</span><span class="op">(</span><span class="va">url</span><span class="op">)</span>, <span class="fl">5</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># удаляем сообщение о том, что надо подождать</span></span>
<span>  <span class="va">bot</span><span class="op">$</span><span class="fu">deleteMessage</span><span class="op">(</span><span class="va">update</span><span class="op">$</span><span class="fu">from_chat_id</span><span class="op">(</span><span class="op">)</span>, <span class="va">mid</span><span class="op">$</span><span class="va">message_id</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># формируем список кнопок</span></span>
<span>  <span class="va">keys</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardButton.html">InlineKeyboardButton</a></span><span class="op">(</span><span class="va">posts</span><span class="op">$</span><span class="va">item_title</span><span class="op">[</span><span class="va">x</span><span class="op">]</span>, url <span class="op">=</span> <span class="va">posts</span><span class="op">$</span><span class="va">item_link</span><span class="op">[</span><span class="va">x</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># формируем клавиатуру</span></span>
<span>  <span class="va">IKM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardMarkup.html">InlineKeyboardMarkup</a></span><span class="op">(</span></span>
<span>    inline_keyboard <span class="op">=</span>  <span class="va">keys</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># отправляем информацию о погоде</span></span>
<span>  <span class="va">bot</span><span class="op">$</span><span class="fu">sendMessage</span><span class="op">(</span>chat_id <span class="op">=</span> <span class="va">update</span><span class="op">$</span><span class="fu">from_chat_id</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                  text    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"5 наиболее свежих статей из Хаба "</span>, <span class="va">hub</span><span class="op">)</span>,</span>
<span>                  reply_markup <span class="op">=</span> <span class="va">IKM</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># создаём фильтры</span></span>
<span><span class="co">## сообщения с текстом Погода</span></span>
<span><span class="va">MessageFilters</span><span class="op">$</span><span class="va">hubs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/BaseFilter.html">BaseFilter</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">message</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="co"># проверяем текст сообщения</span></span>
<span>  <span class="va">message</span><span class="op">$</span><span class="va">text</span> <span class="op">==</span> <span class="st">"Список статей"</span></span>
<span>  </span>
<span><span class="op">}</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># создаём обработчики</span></span>
<span><span class="va">h_start</span>         <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/CommandHandler.html">CommandHandler</a></span><span class="op">(</span><span class="st">'start'</span>, <span class="va">start</span><span class="op">)</span></span>
<span><span class="va">h_hubs</span>          <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/MessageHandler.html">MessageHandler</a></span><span class="op">(</span><span class="va">habs</span>, filters <span class="op">=</span> <span class="va">MessageFilters</span><span class="op">$</span><span class="va">hubs</span><span class="op">)</span></span>
<span><span class="va">h_query_handler</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/CallbackQueryHandler.html">CallbackQueryHandler</a></span><span class="op">(</span><span class="va">answer_cb</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># добавляем обработчики в диспетчер</span></span>
<span><span class="va">updater</span> <span class="op">&lt;-</span> <span class="va">updater</span> <span class="op">+</span></span>
<span>  <span class="va">h_start</span> <span class="op">+</span></span>
<span>  <span class="va">h_hubs</span>  <span class="op">+</span></span>
<span>  <span class="va">h_query_handler</span></span>
<span></span>
<span><span class="co"># запускаем бота</span></span>
<span><span class="va">updater</span><span class="op">$</span><span class="fu">start_polling</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p></p>
<blockquote>
<p>Запустите приведённый выше пример кода, предварительно заменив ‘ТОКЕН ВАШЕГО БОТА’ на реальный токен, который вы получили при создании бота через <em>BotFather</em>.</p>
</blockquote>
<div class="inline-figure">В итоге мы получим вот такой результат:
<img src="https://img.netpeak.ua/alsey/159905964234_kiss_178kb.png">
</div>
<p>Список доступных для выбора Хабов мы вбили хардкодом, в методе <code>habs</code>:</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Метод вызова Inine клавиатуры</span></span>
<span><span class="va">habs</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">bot</span>, <span class="va">update</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="va">IKM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardMarkup.html">InlineKeyboardMarkup</a></span><span class="op">(</span></span>
<span>    inline_keyboard <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardButton.html">InlineKeyboardButton</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">'R'</span>, callback_data <span class="op">=</span> <span class="st">'r'</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardButton.html">InlineKeyboardButton</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">'Data Mining'</span>, callback_data <span class="op">=</span> <span class="st">'data_mining'</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardButton.html">InlineKeyboardButton</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">'Data Engineering'</span>, callback_data <span class="op">=</span> <span class="st">'data_engineering'</span><span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardButton.html">InlineKeyboardButton</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">'Big Data'</span>, callback_data <span class="op">=</span> <span class="st">'bigdata'</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardButton.html">InlineKeyboardButton</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">'Python'</span>, callback_data <span class="op">=</span> <span class="st">'python'</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardButton.html">InlineKeyboardButton</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">'Визуализация данных'</span>, callback_data <span class="op">=</span> <span class="st">'data_visualization'</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Send Inline Keyboard</span></span>
<span>  <span class="va">bot</span><span class="op">$</span><span class="fu">sendMessage</span><span class="op">(</span>chat_id <span class="op">=</span> <span class="va">update</span><span class="op">$</span><span class="va">message</span><span class="op">$</span><span class="va">chat_id</span>,</span>
<span>                  text <span class="op">=</span> <span class="st">"Выберите Хаб"</span>,</span>
<span>                  reply_markup <span class="op">=</span> <span class="va">IKM</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Список статей из указанного Хаба мы получаем командой <code>tidyfeed()</code>, из пакета <code>tidyRSS</code>. Из полученной таблицы с помощью команды <code><a href="https://rdrr.io/r/utils/head.html">head()</a></code> оставляем только 5 самых верхних, которые и являются самыми свежими статьями.</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># получаем из сообщения название хаба</span></span>
<span>  <span class="va">hub</span> <span class="op">&lt;-</span> <span class="va">update</span><span class="op">$</span><span class="va">callback_query</span><span class="op">$</span><span class="va">data</span></span>
<span>  </span>
<span>  <span class="co"># запрашиваем RSS Feed по Хабу</span></span>
<span>  <span class="va">url</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">'https://habr.com/ru/rss/hub/'</span>, <span class="va">hub</span>, <span class="st">'/'</span><span class="op">)</span></span>
<span>  <span class="va">posts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu">tidyfeed</span><span class="op">(</span><span class="va">url</span><span class="op">)</span>, <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p>Логика очень схожа с предыдущим ботом, но в данном случае Inline клавиатуру со списком статей мы генерируем динамически с помощью функции <code><a href="https://rdrr.io/r/base/lapply.html">lapply()</a></code>.</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># формируем список кнопок</span></span>
<span>  <span class="va">keys</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardButton.html">InlineKeyboardButton</a></span><span class="op">(</span><span class="va">posts</span><span class="op">$</span><span class="va">item_title</span><span class="op">[</span><span class="va">x</span><span class="op">]</span>, url <span class="op">=</span> <span class="va">posts</span><span class="op">$</span><span class="va">item_link</span><span class="op">[</span><span class="va">x</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># формируем клавиатуру</span></span>
<span>  <span class="va">IKM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/telegram.bot/man/InlineKeyboardMarkup.html">InlineKeyboardMarkup</a></span><span class="op">(</span></span>
<span>    inline_keyboard <span class="op">=</span>  <span class="va">keys</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<p>В текст кнопки мы подставляем название статьи <code>posts$item_title[x]</code>, а в аргумент <code>url</code> ссылку на статью: <code>url = posts$item_link[x]</code>.</p>
<p>Далее, создаём фильтр, обработчики и запускаем нашего бота.</p>
</div>
</div>
<div id="заключение-2" class="section level2" number="3.5">
<h2>
<span class="header-section-number">3.5</span> Заключение<a class="anchor" aria-label="anchor" href="#%D0%B7%D0%B0%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%BD%D0%B8%D0%B5-2"><i class="fas fa-link"></i></a>
</h2>
<p>Вы сделали отличную работу, научившись настраивать клавиатуры для вашего бота. Теперь ваш бот может предлагать пользователям удобные варианты для взаимодействия. В следующей главе мы перейдем к построению диалогов, чтобы создать более сложные и естественные взаимодействия между пользователями и вашим ботом. Приготовьтесь углубиться в детали создания диалоговых последовательностей!</p>
</div>
<div id="тесты-и-задания-2" class="section level2" number="3.6">
<h2>
<span class="header-section-number">3.6</span> Тесты и задания<a class="anchor" aria-label="anchor" href="#%D1%82%D0%B5%D1%81%D1%82%D1%8B-%D0%B8-%D0%B7%D0%B0%D0%B4%D0%B0%D0%BD%D0%B8%D1%8F-2"><i class="fas fa-link"></i></a>
</h2>
<div id="тесты-2" class="section level3" number="3.6.1">
<h3>
<span class="header-section-number">3.6.1</span> Тесты<a class="anchor" aria-label="anchor" href="#%D1%82%D0%B5%D1%81%D1%82%D1%8B-2"><i class="fas fa-link"></i></a>
</h3>
<p>Для закрепления материла рекомендую вам пройти тест доступный по <a href="https://onlinetestpad.com/t/build-tg-bot-in-r-3">ссылке</a>.</p>
</div>
<div id="задания-2" class="section level3" number="3.6.2">
<h3>
<span class="header-section-number">3.6.2</span> Задания<a class="anchor" aria-label="anchor" href="#%D0%B7%D0%B0%D0%B4%D0%B0%D0%BD%D0%B8%D1%8F-2"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>Создайте бота, который будет поддерживать Reply клавиатуру. На Reply клавиатуре будет всего одна кнопка “Время”. По нажатию на неё будет появляться Inline клавиатура с выбором из 6 часовых поясов.</li>
</ol>
<ul>
<li>Africa/Cairo</li>
<li>America/Chicago</li>
<li>Europe/Moscow</li>
<li>Asia/Bangkok</li>
<li>Europe/Kiev</li>
<li>Australia/Sydney</li>
</ul>
<p>Кнопки Inline клавиатуры необходимо расположить по 2 в ряд, соответвенно в три ряда.</p>
<p>По нажатию на одну из кнопки Inline клавиатуры бот будет запрашивать информацию по текущему времени из API <a href="http://worldtimeapi.org/">worldtimeapi.org</a>.</p>
<p>Формат запроса к API: <code>http://worldtimeapi.org/api/timezone/{area}/:{location}</code>.</p>
<p>Где <a href="https://github.com/hypertidy/area">area</a> это континент, например Europe, а <code>{location}</code> это город, например Kiev. Дату и время надо брать в ответе из компонента <code>datetime</code>.</p>
<p>Если вы всё сделали правильно результат будет такой:</p>
<div class="inline-figure"><img src="http://img.netpeak.ua/alsey/160410549780_kiss_146kb.png"></div>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%BB%D1%8F%D0%B5%D0%BC-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BE%D0%BC%D0%B0%D0%BD%D0%B4-%D0%B8-%D1%84%D0%B8%D0%BB%D1%8C%D1%82%D1%80%D1%8B-%D1%81%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D0%B9-%D0%BA%D0%BB%D0%B0%D1%81%D1%81-updater.html"><span class="header-section-number">2</span> Добавляем боту поддержку команд и фильтры сообщений, класс Updater</a></div>
<div class="next"><a href="%D0%BF%D0%BE%D1%81%D1%82%D1%80%D0%BE%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D0%BE%D1%81%D0%BB%D0%B5%D0%B4%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D0%BE%D0%B3%D0%BE-%D0%BB%D0%BE%D0%B3%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%BE%D0%B3%D0%BE-%D0%B4%D0%B8%D0%B0%D0%BB%D0%BE%D0%B3%D0%B0-%D1%81-%D0%B1%D0%BE%D1%82%D0%BE%D0%BC.html"><span class="header-section-number">4</span> Построение последовательного, логического диалога с ботом</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#%D0%BA%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B"><span class="header-section-number">3</span> Как добавить боту поддержку клавиатуры</a></li>
<li><a class="nav-link" href="#%D0%B2%D0%B8%D0%B4%D0%B5%D0%BE-%D1%83%D1%80%D0%BE%D0%BA-%D0%BF%D0%BE-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D1%8E-%D0%B1%D0%BE%D1%82%D1%83-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B"><span class="header-section-number">3.1</span> Видео урок по добавлению боту клавиатуры</a></li>
<li><a class="nav-link" href="#%D0%BA%D0%B0%D0%BA%D0%B8%D0%B5-%D1%82%D0%B8%D0%BF%D1%8B-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%B8%D0%B2%D0%B0%D0%B5%D1%82-%D1%82%D0%B5%D0%BB%D0%B5%D0%B3%D1%80%D0%B0%D0%BC-%D0%B1%D0%BE%D1%82"><span class="header-section-number">3.2</span> Какие типы клавиатур поддерживает телеграм бот</a></li>
<li>
<a class="nav-link" href="#reply-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D0%B0"><span class="header-section-number">3.3</span> Reply клавиатура</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#%D0%BA%D0%B0%D0%BA-%D0%B7%D0%B0%D0%BF%D1%80%D0%BE%D1%81%D0%B8%D1%82%D1%8C-%D1%83-%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8F-%D0%BD%D0%BE%D0%BC%D0%B5%D1%80-%D1%82%D0%B5%D0%BB%D0%B5%D1%84%D0%BE%D0%BD%D0%B0-%D0%B8-%D0%BB%D0%BE%D0%BA%D0%B0%D1%86%D0%B8%D1%8E"><span class="header-section-number">3.3.1</span> Как запросить у пользователя номер телефона и локацию</a></li></ul>
</li>
<li>
<a class="nav-link" href="#inline-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D0%B0"><span class="header-section-number">3.4</span> Inline клавиатура</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#%D0%BF%D1%80%D0%B8%D0%BC%D0%B5%D1%80-%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%B5%D0%B9%D1%88%D0%B5%D0%B3%D0%BE-%D0%B1%D0%BE%D1%82%D0%B0-%D1%81-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D0%BE%D0%B9-inline-%D0%BA%D0%BD%D0%BE%D0%BF%D0%BE%D0%BA"><span class="header-section-number">3.4.1</span> Пример простейшего бота с поддержкой InLine кнопок</a></li>
<li><a class="nav-link" href="#%D0%BF%D1%80%D0%B8%D0%BC%D0%B5%D1%80-%D0%B1%D0%BE%D1%82%D0%B0-%D0%BA%D0%BE%D1%82%D0%BE%D1%80%D1%8B%D0%B9-%D1%81%D0%BE%D0%BE%D0%B1%D1%89%D0%B0%D0%B5%D1%82-%D1%82%D0%B5%D0%BA%D1%83%D1%89%D1%83%D1%8E-%D0%BF%D0%BE%D0%B3%D0%BE%D0%B4%D1%83-%D0%BF%D0%BE-%D0%B2%D1%8B%D0%B1%D1%80%D0%B0%D0%BD%D0%BD%D0%BE%D0%BC%D1%83-%D0%B3%D0%BE%D1%80%D0%BE%D0%B4%D1%83"><span class="header-section-number">3.4.2</span> Пример бота, который сообщает текущую погоду по выбранному городу</a></li>
<li><a class="nav-link" href="#%D0%BF%D1%80%D0%B8%D0%BC%D0%B5%D1%80-%D0%B1%D0%BE%D1%82%D0%B0-%D0%BA%D0%BE%D1%82%D0%BE%D1%80%D1%8B%D0%B9-%D0%B2%D1%8B%D0%B2%D0%BE%D0%B4%D0%B8%D1%82-%D1%81%D0%BF%D0%B8%D1%81%D0%BE%D0%BA-%D1%81%D0%B0%D0%BC%D1%8B%D1%85-%D1%81%D0%B2%D0%B5%D0%B6%D0%B8%D1%85-%D1%81%D1%82%D0%B0%D1%82%D0%B5%D0%B9-%D1%81%D0%BE-%D1%81%D1%81%D1%8B%D0%BB%D0%BA%D0%B0%D0%BC%D0%B8-%D0%BF%D0%BE-%D1%83%D0%BA%D0%B0%D0%B7%D0%B0%D0%BD%D0%BD%D0%BE%D0%BC%D1%83-%D1%85%D0%B0%D0%B1%D1%83-%D0%B8%D0%B7-habr.com"><span class="header-section-number">3.4.3</span> Пример бота, который выводит список самых свежих статей со ссылками по-указанному Хабу из habr.com</a></li>
</ul>
</li>
<li><a class="nav-link" href="#%D0%B7%D0%B0%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%BD%D0%B8%D0%B5-2"><span class="header-section-number">3.5</span> Заключение</a></li>
<li>
<a class="nav-link" href="#%D1%82%D0%B5%D1%81%D1%82%D1%8B-%D0%B8-%D0%B7%D0%B0%D0%B4%D0%B0%D0%BD%D0%B8%D1%8F-2"><span class="header-section-number">3.6</span> Тесты и задания</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#%D1%82%D0%B5%D1%81%D1%82%D1%8B-2"><span class="header-section-number">3.6.1</span> Тесты</a></li>
<li><a class="nav-link" href="#%D0%B7%D0%B0%D0%B4%D0%B0%D0%BD%D0%B8%D1%8F-2"><span class="header-section-number">3.6.2</span> Задания</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Разработка telegram ботов на языке R</strong>" was written by Алексей Селезнёв. It was last built on 2025-05-07.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
